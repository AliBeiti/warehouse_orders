{% extends "base.html" %}
{% block title %}SipariÅŸ Bilgileri{% endblock %}

{% block content %}
<div class="page-wrapper">
  
  <!-- Progress Bar -->
  <div class="progress-bar">
    <div class="progress-step active">
      <div class="step-number">1</div>
      <div class="step-label">Bilgiler</div>
    </div>
    <div class="progress-step">
      <div class="step-number">2</div>
      <div class="step-label">ÃœrÃ¼nler</div>
    </div>
    <div class="progress-step">
      <div class="step-number">3</div>
      <div class="step-label">Onay</div>
    </div>
  </div>

  <!-- Welcome Section -->
  <section class="section-card">
    <div class="section-header">
      <h1 class="section-title">HoÅŸ Geldiniz!</h1>
      <p class="section-subtitle">SipariÅŸ vermek iÃ§in lÃ¼tfen bilgilerinizi giriniz.</p>
    </div>

    <!-- Instructions Box -->
    <div class="info-box">
      <h3>ğŸ“ SipariÅŸ NasÄ±l Verilir?</h3>
      <ol class="instruction-list">
        <li><strong>Bilgilerinizi girin:</strong> Ä°sim, telefon ve e-posta adresinizi doldurun</li>
        <li><strong>ÃœrÃ¼nleri seÃ§in:</strong> Ä°stediÄŸiniz Ã¼rÃ¼nleri ve miktarlarÄ± belirleyin</li>
        <li><strong>Kontrol edin:</strong> SipariÅŸ Ã¶zetini inceleyin ve dÃ¼zeltin</li>
        <li><strong>OnaylayÄ±n:</strong> SipariÅŸinizi onaylayÄ±n ve bize gÃ¶nderelim!</li>
      </ol>

      <div class="info-note">
        <strong>ğŸ’¡ Ä°pucu:</strong> Bilgileriniz bir sonraki adÄ±ma kadar saklanÄ±r. 
        Ä°stediÄŸiniz zaman geri dÃ¶nÃ¼p dÃ¼zeltebilirsiniz.
      </div>
    </div>
  </section>


  <!-- Discount Information Box -->
{% if discount_tiers %}
<div class="info-box discount-box">
  <h3>ğŸ Ä°ndirim FÄ±rsatlarÄ±</h3>
  <p>SipariÅŸ tutarÄ±nÄ±za gÃ¶re otomatik indirim kazanÄ±n!</p>
  
  <div class="discount-tiers">
    {% for tier in discount_tiers %}
    <div class="discount-tier-item">
      <span class="tier-threshold">{{ tier.threshold|floatformat:0 }} TL ve Ã¼zeri</span>
      <span class="tier-arrow">â†’</span>
      <span class="tier-discount">%{{ tier.discount_percentage|floatformat:0 }} Ä°ndirim</span>
    </div>
    {% endfor %}
  </div>


  <div class="info-note">
    <strong>ğŸ’° Ã–nemli:</strong> Ä°ndirimler sepet toplamÄ±nÄ±za gÃ¶re otomatik olarak uygulanÄ±r. 
    SipariÅŸ Ã¶zet sayfasÄ±nda indirimli fiyatÄ±nÄ±zÄ± gÃ¶rebilirsiniz.
  </div>
</div>
{% endif %}

  <!-- Customer Info Form -->
<section class="section-card">
  <div class="section-header">
    <h2 class="section-title">Ä°letiÅŸim Bilgileri</h2>
    <p class="section-subtitle">SipariÅŸ takibi iÃ§in gereklidir.</p>
  </div>

  {% if error_list %}
    <div class="error-box">
      <ul class="error-list">
        {% for e in error_list %}
          <li>{{ e }}</li>
        {% endfor %}
      </ul>
    </div>
  {% endif %}

  <form method="POST" action="{% url 'customer_info' customer_type=request.resolver_match.kwargs.customer_type %}">
    {% csrf_token %}

    <div class="customer-form">
      <div class="form-row">
        <div class="form-group">
          <label for="customer_name">
            Ä°sim Soyisim<span class="required-star">*</span>
          </label>
          <input 
            type="text" 
            id="customer_name"
            name="customer_name" 
            required
            value="{{ customer_name|default_if_none:'' }}"
            placeholder="Ahmet YÄ±lmaz"
            class="form-control">
          <small class="form-text">Fatura Ã¼zerinde gÃ¶rÃ¼necektir</small>
        </div>

        <div class="form-group">
          <label for="customer_phone">
            Telefon<span class="required-star">*</span>
          </label>
          <input 
            type="tel" 
            id="customer_phone"
            name="customer_phone" 
            required
            value="{{ customer_phone|default_if_none:'' }}"
            placeholder="0532 123 45 67"
            class="form-control">
          <small class="form-text">SMS ile bilgilendirme yapÄ±labilir</small>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="customer_email">E-posta</label>
          <input 
            type="email" 
            id="customer_email"
            name="customer_email"
            value="{{ customer_email|default_if_none:'' }}"
            placeholder="ornek@email.com"
            class="form-control">
          <small class="form-text">SipariÅŸ Ã¶zeti e-posta ile gÃ¶nderilir (isteÄŸe baÄŸlÄ±)</small>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group full-width">
          <label for="customer_note">Notlar (Ä°steÄŸe BaÄŸlÄ±)</label>
          <textarea 
            id="customer_note"
            name="customer_note" 
            rows="4"
            placeholder="Ã–zel talepleriniz, teslimat talimatlarÄ± veya notlarÄ±nÄ±z..."
            class="form-control">{{ customer_note|default_if_none:'' }}</textarea>
          <small class="form-text">Teslimat talimatlarÄ±, tercihler vb.</small>
        </div>
      </div>

      <div class="form-actions-center">
        <button type="submit" class="primary-btn btn-large">
          Devam Et: ÃœrÃ¼n SeÃ§imi â†’
        </button>
      </div>
    </div>
  </form>
</section>

  <!-- Help Section -->
  <section class="section-card help-section">
    <h3>â“ YardÄ±ma mÄ± ihtiyacÄ±nÄ±z var?</h3>
    <p>SorularÄ±nÄ±z iÃ§in bize ulaÅŸÄ±n:</p>
    <div class="contact-info">
      <div>ğŸ“ <strong>Telefon:</strong> 0530 077 37 72</div>
      <div style="color: #25D366;">ğŸ’¬ <strong>WhatsApp:</strong> 0530 077 37 72</div>
      <div>âœ‰ï¸ <strong>E-posta:</strong> info@masterbest.com</div>
    </div>
  </section>

</div>
{% endblock %}