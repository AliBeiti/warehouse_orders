{% extends "base.html" %}
{% block title %}Siparişi Kontrol Et{% endblock %}

{% block content %}
<div class="page-wrapper">
  <section class="section-card">
    <h2 class="section-title">Sipariş Özeti</h2>

    {% if order %}
      <p><strong>İsim:</strong> {{ order.customer_name }}</p>
      {% if order.customer_phone %}<p><strong>Telefon:</strong> {{ order.customer_phone }}</p>{% endif %}
      {% if order.customer_email %}<p><strong>E-posta:</strong> {{ order.customer_email }}</p>{% endif %}
      {% if order.customer_note %}<p><strong>Notlar:</strong> {{ order.customer_note }}</p>{% endif %}
    {% endif %}

    {% if items %}
      <h3>Ürünler</h3>

      <table style="width:100%; border-collapse: collapse; margin-bottom: 16px;">
        <thead>
          <tr>
            <th style="border-bottom:1px solid #ccc; text-align:left; padding:6px;">Ürün</th>
            <th style="border-bottom:1px solid #ccc; text-align:right; padding:6px;">Adet</th>
            <th style="border-bottom:1px solid #ccc; text-align:right; padding:6px;">Birim fiyat</th>
            <th style="border-bottom:1px solid #ccc; text-align:right; padding:6px;">Ara toplam</th>
          </tr>
        </thead>
        <tbody>
          {% for line in items %}
            <tr>
              <td style="border-bottom:1px solid #eee; padding:6px;">
                {{ line.product.name }}
                {% if line.product.code %}
                  <br><span class="muted">Kod: {{ line.product.code }}</span>
                {% endif %}
                {% if line.product.unit %}
                  <br><span class="muted">Birim: {{ line.product.unit }}</span>
                {% endif %}
                {% if line.product.discount_percent or line.product.discount_price %}
                  <br><span style="font-size:0.8rem; color:#e67e22;">
                    İndirimli ürün
                  </span>
                {% endif %}
              </td>
              <td style="border-bottom:1px solid #eee; padding:6px; text-align:right;">
                {{ line.quantity }}
              </td>
              <td style="border-bottom:1px solid #eee; padding:6px; text-align:right;">
                {{ line.unit_price }} ₺
              </td>
              <td style="border-bottom:1px solid #eee; padding:6px; text-align:right;">
                {{ line.line_total }} ₺
              </td>
            </tr>
          {% endfor %}
        </tbody>
        <tfoot>
          <tr>
            <td colspan="3" style="padding:6px; text-align:right; font-weight:bold;">
              Toplam:
            </td>
            <td style="padding:6px; text-align:right; font-weight:bold;">
              {{ total }} ₺
            </td>
          </tr>
        </tfoot>
      </table>

      <form method="post" action="{% url 'order_confirm' %}">
        {% csrf_token %}
        <button type="submit"
                style="margin-top:10px; padding:8px 16px; font-size:16px;">
          Siparişi Onayla
        </button>
      </form>
    {% else %}
      <p>Bu sipariş için ürün bulunamadı.</p>
    {% endif %}
  </section>
</div>
{% endblock %}
