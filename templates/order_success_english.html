{% extends "base.html" %}
{% block title %}Review Your Order{% endblock %}

{% block content %}
<h2>Review Your Order</h2>

{% if order %}
  <p><strong>Name:</strong> {{ order.customer_name }}</p>
  {% if order.customer_phone %}<p><strong>Phone:</strong> {{ order.customer_phone }}</p>{% endif %}
  {% if order.customer_email %}<p><strong>Email:</strong> {{ order.customer_email }}</p>{% endif %}
  {% if order.customer_note %}<p><strong>Notes:</strong> {{ order.customer_note }}</p>{% endif %}
{% endif %}

{% if items %}
  <h3>Items</h3>

  <table style="width:100%; border-collapse: collapse; margin-bottom: 16px;">
    <thead>
      <tr>
        <th style="border-bottom:1px solid #ccc; text-align:left; padding:6px;">Product</th>
        <th style="border-bottom:1px solid #ccc; text-align:right; padding:6px;">Qty</th>
        <th style="border-bottom:1px solid #ccc; text-align:right; padding:6px;">Unit price</th>
        <th style="border-bottom:1px solid #ccc; text-align:right; padding:6px;">Line total</th>
      </tr>
    </thead>
    <tbody>
      {% for line in items %}
        <tr>
          <td style="border-bottom:1px solid #eee; padding:6px;">
            {{ line.product.name }}
            {% if line.product.code %}
              <br><span class="muted">Code: {{ line.product.code }}</span>
            {% endif %}
            {% if line.product.unit %}
              <br><span class="muted">Unit: {{ line.product.unit }}</span>
            {% endif %}
            {% if line.product.discount_percent %}
              <br><span style="font-size:0.8rem; color:#e67e22;">
                Discount: -{{ line.product.discount_percent }}%
              </span>
            {% endif %}
          </td>
          <td style="border-bottom:1px solid #eee; padding:6px; text-align:right;">
            {{ line.quantity }}
          </td>
          <td style="border-bottom:1px solid #eee; padding:6px; text-align:right;">
            {{ line.unit_price }} ₺
          </td>
          <td style="border-bottom:1px solid #eee; padding:6px; text-align:right;">
            {{ line.line_total }} ₺
          </td>

        </tr>
      {% endfor %}
    </tbody>
    <tfoot>
      <tr>
        <td colspan="3" style="padding:6px; text-align:right; font-weight:bold;">
          Total:
        </td>
        <td style="padding:6px; text-align:right; font-weight:bold;">
          {{ total }} ₺
        </td>
      </tr>
    </tfoot>
  </table>

  <form method="post" action="{% url 'order_confirm' %}">
    {% csrf_token %}
    <button type="submit"
            style="margin-top:10px; padding:8px 16px; font-size:16px;">
      Confirm Order
    </button>
  </form>
{% else %}
  <p>No items found.</p>
{% endif %}
{% endblock %}
